"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.buildTaskGraph=void 0;const hvigor_base_1=require("@ohos/hvigor-base"),task_executor_js_1=require("../core/task-executor.js"),_log=hvigor_base_1.HvigorLogger.getLogger("hvigor-build-task-graph");function buildTaskGraph(e){function s(e,s){e.forEach((e=>{const t=e.getNode().getName(),a=e.getName(),o=e.getPath();for(const r of e.getDependsOn()){const e=(0,task_executor_js_1.getModuleFromTaskPath)(r);if(void 0===e){const e=`Can not find the node '${r}' in '${t}:${a}'`;_log.errorMessageExit(e)}const g=(0,hvigor_base_1.getTaskNameFromTaskPath)(r);if(!e.getTaskContainer().hasTask(g)){const s=`'${a}' in ${t} missing depends task '${g}' in ${e.getName()}`;_log.errorMessageExit(s)}if(s.addEdge(o,r),!hvigor_base_1.projectTaskDag.addEdge(o,r)){const e=`Circular dependency between the following tasks:${o}->${r}`;_log.errorMessageExit(e)}}}))}e.getSubModules().forEach((e=>{s(e.getTaskContainer().getAllTasks(),e.getTaskGraph())})),s(e.getTaskContainer().getAllTasks(),e.getTaskGraph())}exports.buildTaskGraph=buildTaskGraph;